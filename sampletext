signals = []

for option in results:
    try:
        details = option["details"]
        day = option["day"]
        oi = option["open_interest"]
        volume = day.get("volume", 0)
        price = day.get("close", 0)
        opt_type = details["option_type"]

        # Remove broken fields
        if opt_type == "call" and volume > oi and price * volume > 200000:
            signals.append({
                "ticker": details["underlying_asset"]["ticker"],
                "strike": details["strike_price"],
                "expiry": details["expiration_date"],
                "entry": price,
                "volume": volume,
                "oi": oi,
                "delta": 0.45,         # Placeholder until delta is available
                "iv_rank": 21,         # Placeholder
                "flow_score": 78,
                "type": "intraday",
                "vwap_breakout": True
            })
    except Exception as e:
        continue